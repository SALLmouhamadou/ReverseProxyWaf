# =============================================================================
# REGLES WAF PERSONNALISEES - BLOCAGE UTILISATEUR
# =============================================================================
# Ce fichier contient des règles ModSecurity personnalisées
# À placer AVANT les règles CRS

# -----------------------------------------------------------------------------
# REGLE 1 : Bloquer l'utilisateur Bender
# -----------------------------------------------------------------------------
SecRule ARGS:email "@streq bender@juice-sh.op" \
    "id:100001,\
    phase:2,\
    deny,\
    status:403,\
    log,\
    msg:'Acces refuse - Utilisateur Bender bloque par politique de securite',\
    tag:'custom-rule',\
    tag:'user-block'"

# -----------------------------------------------------------------------------
# REGLE 2 : Bloquer aussi dans le corps JSON (API login)
# -----------------------------------------------------------------------------
SecRule REQUEST_BODY "@contains bender@juice-sh.op" \
    "id:100002,\
    phase:2,\
    deny,\
    status:403,\
    log,\
    msg:'Acces refuse - Utilisateur Bender bloque (API)',\
    tag:'custom-rule',\
    tag:'user-block'"
